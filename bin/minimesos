#!/bin/sh

command_exists() {
	command -v "$@" > /dev/null 2>&1
}

if ! command_exists docker; then
	echo "Please install docker to use minimesos"
	exit 1
fi

MINIMESOS_TAG="latest"
MESOS_TAG="0.25.0-0.2.70.ubuntu1404"

pullImage() {
  if [ "$(docker images -q $1 2> /dev/null)" = "" ]; then
    echo "Pulling $1" && docker pull "$1"
  fi
}

pullImage "containersol/minimesos:${MINIMESOS_TAG}"
pullImage "containersol/mesos-agent:${MESOS_TAG}"
pullImage "containersol/mesos-master:${MESOS_TAG}"

docker run --rm -v $PWD:/tmp/minimesos -v /var/run/docker.sock:/var/run/docker.sock containersol/minimesos:$MINIMESOS_TAG $@
